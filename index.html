<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Graph Editor</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/toolbar.css">
    <link rel="stylesheet" href="styles/properties.css">
    <link rel="stylesheet" href="styles/minimap.css">
    <link rel="stylesheet" href="styles/contextMenu.css">
    <link rel="stylesheet" href="styles/filter.css">
</head>
<body>
    <!-- Header / Toolbar -->
    <header class="header">
        <div class="header-left">
            <h1 class="app-title">Knowledge Graph Editor</h1>
        </div>
        <div class="toolbar">
            <button id="btn-new" class="toolbar-btn" title="New Graph (Ctrl+N)">
                <span>üìÑ</span> New
            </button>
            <button id="btn-open" class="toolbar-btn" title="Open Graph (Ctrl+O)">
				<span>üìÇ</span> Open
			</button>
			<button id="btn-save" class="toolbar-btn" title="Save Graph (Ctrl+S)">
				<span>üíæ</span> Save
			</button>
			<button id="btn-save-as" class="toolbar-btn" title="Save Graph As">
				<span>üíæ</span> Save As
			</button>
            <button id="btn-export" class="toolbar-btn" title="Export">
                <span>üì§</span> Export
            </button>
            <button id="btn-create-excel-converter" class="toolbar-btn" title="Create Excel Converter">
                <span>üìä</span> Create Excel Converter
            </button>
            <button id="btn-convert-excel" class="toolbar-btn" title="Convert Excel">
                <span>üîÑ</span> Convert Excel
            </button>
            <div class="toolbar-separator"></div>
            <button id="btn-undo" class="toolbar-btn" title="Undo (Ctrl+Z)" disabled>
                <span>‚Ü∂</span>
            </button>
            <button id="btn-redo" class="toolbar-btn" title="Redo (Ctrl+Shift+Z)" disabled>
                <span>‚Ü∑</span>
            </button>
            <div class="toolbar-separator"></div>
            <input type="text" id="search-input" class="search-input" placeholder="Search nodes... (Ctrl+F)">
            <button id="btn-clear-search" class="toolbar-btn-small" title="Clear Search">‚úï</button>
            <button id="btn-filter" class="toolbar-btn" title="Filter Graph">
                <span>üîç</span> Filter
            </button>
        </div>
    </header>

    <!-- Tabs -->
    <div class="tabs-container">
        <div id="tabs" class="tabs"></div>
        <button id="btn-add-tab" class="add-tab-btn" title="New Tab">+</button>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Left Sidebar: Tools -->
		<aside class="left-sidebar">
			<div class="tool-palette">
				<h3>Tools</h3>
				<button id="tool-pan" class="tool-btn" title="Pan (Space)">
					<span>‚úã</span>
					<span class="tool-label">Pan</span>
				</button>
				<div class="tool-separator"></div>
				<button id="btn-freeze" class="tool-btn" title="Freeze Simulation (F)">
					<span>‚ùÑÔ∏è</span>
					<span class="tool-label">Freeze</span>
				</button>
				<button id="btn-layout" class="tool-btn" title="Resimulate">
					<span>‚äû</span>
					<span class="tool-label">Resimulate</span>
				</button>
				<button id="btn-shortest-path" class="tool-btn" title="Shortest Path">
					<span>‚ö°</span>
					<span class="tool-label">Path</span>
				</button>
			</div>
		</aside>

        <!-- Canvas Area -->
        <main class="canvas-container" id="canvas-drop-zone">
            <svg id="graph-canvas" class="graph-canvas"></svg>
            
            <!-- Minimap -->
            <div id="minimap-container" class="minimap-container">
                <svg id="minimap" class="minimap"></svg>
            </div>

            <!-- Loading Overlay -->
            <div id="loading-overlay" class="loading-overlay hidden">
                <div class="spinner"></div>
            </div>
        </main>

        <!-- Right Sidebar: Properties Panel -->
        <aside id="properties-panel" class="right-sidebar hidden">
            <div class="properties-header">
                <h3>Properties</h3>
                <button id="btn-close-properties" class="close-btn">‚úï</button>
            </div>
            <div id="properties-content" class="properties-content">
                <!-- Properties will be dynamically generated -->
            </div>
        </aside>
    </div>

    <!-- Status Bar -->
    <footer class="status-bar">
        <span id="status-nodes">Nodes: 0</span>
        <span class="separator">|</span>
        <span id="status-edges">Edges: 0</span>
        <span class="separator">|</span>
        <span id="status-zoom">Zoom: 100%</span>
        <span class="separator">|</span>
        <span id="status-selection">Selected: None</span>
        <span class="separator">|</span>
        <span id="status-simulation">Simulation: Active</span>
    </footer>

    <!-- Hidden File Input -->
    <input type="file" id="file-input" accept=".json" style="display: none;">
    
    <!-- Hidden Excel File Input for Create Converter -->
    <input type="file" id="excel-converter-input" accept=".xlsx,.xls" style="display: none;">
    
    <!-- Hidden Excel File Input for Convert Excel -->
    <input type="file" id="excel-data-input" accept=".xlsx,.xls" style="display: none;">
    
    <!-- Hidden Mapping JSON Input for Convert Excel -->
    <input type="file" id="mapping-json-input" accept=".json" style="display: none;">

    <!-- Export Modal -->
    <div id="export-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Export Graph</h3>
                <button class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <button id="export-json" class="export-option">
                    <span>üìÑ</span> Export as JSON
                </button>
                <button id="export-png" class="export-option">
                    <span>üñºÔ∏è</span> Export as PNG
                </button>
                <button id="export-svg" class="export-option">
                    <span>üìê</span> Export as SVG
                </button>
            </div>
        </div>
    </div>

    <!-- Shortest Path Modal -->
    <div id="path-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Find Shortest Path</h3>
                <button class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="property-item">
                    <label class="property-label">Start Node</label>
                    <select class="property-input" id="path-start-select">
                        <option value="">-- Select Start Node --</option>
                    </select>
                </div>

                <div class="property-item">
                    <label class="property-label">End Node</label>
                    <select class="property-input" id="path-end-select">
                        <option value="">-- Select End Node --</option>
                    </select>
                </div>

                <button id="btn-calculate-path" class="modal-btn" disabled>Calculate Path</button>
                <button id="btn-clear-path" class="modal-btn">Clear Path</button>
            </div>
        </div>
    </div>

    <!-- Filter Modal -->
    <div id="filter-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Filter Graph</h3>
                <button class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="filter-group">
                    <label class="filter-label">Property Name:</label>
                    <input type="text" id="filter-property" class="filter-input" placeholder="e.g., category, priority">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Property Value:</label>
                    <input type="text" id="filter-value" class="filter-input" placeholder="e.g., High, Field">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Match Type:</label>
                    <select id="filter-match-type" class="filter-select">
                        <option value="exact">Exact Match</option>
                        <option value="contains">Contains</option>
                        <option value="starts">Starts With</option>
                        <option value="ends">Ends With</option>
                    </select>
                </div>
                <button id="btn-apply-filter" class="modal-btn">Apply Filter</button>
                <button id="btn-clear-filter" class="modal-btn" style="background-color: var(--border-color);">Clear Filter</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu" class="context-menu hidden">
        <!-- Dynamically populated -->
    </div>

    <!-- SheetJS Library for Excel Processing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <!-- D3.js Library -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <!-- JavaScript Modules -->
    <script src="js/utils.js"></script>
    <script src="js/graph.js"></script>
    <script src="js/history.js"></script>
    <script src="js/algorithms.js"></script>
    <script src="js/renderer.js"></script>
    <script src="js/properties.js"></script>
    <script src="js/minimap.js"></script>
    <script src="js/search.js"></script>
    <script src="js/filter.js"></script>
    <script src="js/contextMenu.js"></script>
    <script src="js/tabManager.js"></script>
    <script src="js/fileManager.js"></script>
    <script src="js/excelConverter.js"></script>
    <script src="js/app.js"></script>
</body>
</html>